# スプレッドシート自動更新セットアップ

## 手順

### 1. サービスアカウントにスプレッドシートの編集権限を付与

1. **Google Sheetsを開く**
2. **「共有」ボタンをクリック**
3. **「ユーザーやグループを追加」に以下のメールアドレスを入力：**
   ```
   video-editor-service@video-editor-project-463309.iam.gserviceaccount.com
   ```
4. **権限を「編集者」に設定**
5. **「送信」をクリック**

### 2. 動作確認

「スプレッドシートから実行」を実行すると：

✅ **自動で実行されること：**
- L列に動画URLが自動記録
- A列の○マークが自動削除
- 手作業は一切不要

❌ **権限が不足している場合：**
- ログに「Sheets API更新失敗」エラーが表示
- 手動でのコピペが必要

### 3. 権限が正しく設定されている場合のログ

```
✅ 動画生成完了: my_video1.mp4
🔄 Sheets API で L2 を更新中: "https://web-video-editor.onrender.com/output/my_video1.mp4"
✅ Sheets API 更新成功: L2
📋 行2に動画URLを記録しました: https://web-video-editor.onrender.com/output/my_video1.mp4
🔄 Sheets API で A2 を更新中: ""
✅ Sheets API 更新成功: A2
✅ 行2の実行フラグをクリアしました
🎉 スプレッドシート自動更新完了: 行2
```

### 4. トラブルシューティング

**Q: 「Sheets API更新失敗」エラーが出る**
A: サービスアカウントのメールアドレスがスプレッドシートの編集者として追加されているか確認してください

**Q: 権限エラーが出る**  
A: スプレッドシートの共有設定で「video-editor-service@video-editor-project-463309.iam.gserviceaccount.com」が「編集者」権限になっているか確認してください

**Q: 一部だけ更新される**
A: L列の更新は成功したがA列の更新に失敗する場合、シートの保護設定を確認してください

## 完全自動化された動作

1. スプレッドシートでA列に「○」を入力
2. 「スプレッドシートから実行」ボタンをクリック
3. **自動で動画処理が実行**
4. **自動でL列に動画URLが記録**
5. **自動でA列の○が削除**
6. 完了！手作業は一切不要

これで完全な自動化が実現されます！