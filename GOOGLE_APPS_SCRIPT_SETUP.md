# Google Apps Script セットアップ手順

スプレッドシートから直接動画処理を実行できるようにするための設定手順です。

## 📋 セットアップ手順

### 1. Google Apps Scriptエディタを開く

1. **動画処理用のGoogle Sheetsを開く**
2. **メニューバー「拡張機能」→「Apps Script」をクリック**
3. **新しいタブでApps Scriptエディタが開く**

### 2. コードを貼り付ける

1. **既存のコード（`function myFunction()...`）を全て削除**
2. **`google-apps-script-code.gs`の内容を全てコピー**
3. **Apps Scriptエディタに貼り付け**

### 3. 保存とデプロイ

1. **プロジェクト名を「Web Video Editor」に変更**（任意）
2. **Ctrl+S または Cmd+S で保存**
3. **「デプロイ」ボタンは不要**（スプレッドシート内でのみ使用）

### 4. 初回実行と権限付与

1. **Google Sheetsに戻る**
2. **ページをリロード（F5）**
3. **メニューバーに「🎬 動画エディター」が表示される**
4. **「🎬 動画エディター」→「設定」をクリック**
5. **「承認が必要です」ダイアログが表示されたら：**
   - 「続行」をクリック
   - Googleアカウントを選択
   - 「詳細」をクリック
   - 「Web Video Editor（安全ではないページ）に移動」をクリック
   - 「許可」をクリック

## 🎬 使い方

### 基本的な使い方

1. **スプレッドシートでデータを準備**
   - A列: `○`（実行フラグ）
   - B列: 画像URL
   - C列: 動画URL
   - D列: 音声URL
   - E列: 動画時間（秒）
   - F列: 出力ファイル名

2. **メニューから実行**
   - 「🎬 動画エディター」→「実行（○マークの行を処理）」

3. **自動処理**
   - バックグラウンドで動画処理実行
   - 完了すると自動通知
   - L列に動画URL記録
   - A列の○削除

### メニュー機能

- **実行（○マークの行を処理）**
  - ○マークがある行の動画を一括処理
  
- **処理状況を確認**
  - 現在の処理状況を表示
  
- **設定**
  - 使い方とシステム情報を表示

## ⚠️ 注意事項

- **処理時間**: 動画の数やサイズにより数分かかる場合があります
- **同時実行**: 処理中に再度実行しないでください
- **エラー時**: Renderのログを確認してください

## 🔧 トラブルシューティング

### Q: メニューが表示されない
A: ページをリロードしてください

### Q: 「承認が必要です」と表示される
A: 上記の権限付与手順を実行してください

### Q: 処理が完了しない
A: 「処理状況を確認」で状態を確認し、Renderのログも確認してください

### Q: エラーが発生する
A: 以下を確認してください：
- スプレッドシートのURLが公開設定になっているか
- ファイルURLが正しくアクセス可能か
- サービスアカウントに編集権限があるか

## 🎉 セットアップ完了！

これでスプレッドシートから直接動画処理を実行できます！
Web版も引き続き利用可能です。